#!/usr/bin/env pwsh

# Pre-commit hook to prevent direct commits to main/master branches
# This enforces a branching strategy where all work must be done on feature branches

$branch = git symbolic-ref --short HEAD 2>$null

if ($branch -eq "main" -or $branch -eq "master") {
    Write-Host ""
    Write-Host "‚ùå ERROR: Direct commits to '$branch' branch are not allowed!" -ForegroundColor Red
    Write-Host ""
    Write-Host "This repository enforces a branching strategy." -ForegroundColor Yellow
    Write-Host "Please create a feature branch and commit there instead:" -ForegroundColor Yellow
    Write-Host ""
    Write-Host "  git checkout -b feature/your-feature-name" -ForegroundColor Cyan
    Write-Host "  git commit -m 'Your commit message'" -ForegroundColor Cyan
    Write-Host ""
    Write-Host "Then create a Pull Request to merge into $branch." -ForegroundColor Yellow
    Write-Host ""
    exit 1
}

# Allow commit to proceed
exit 0
